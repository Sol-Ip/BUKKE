<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="activityMapper">
	
	<resultMap type="Activity" id="ActivityResultMap">
		<id property="activityNo" column="ACTIVITY_NO"></id>
		<result property="shopId" column="SHOP_ID"></result> 
		<result property="activityName" column="ACTIVITY_NAME"></result> 
		<result property="activityAddr" column="ACTIVITY_ADDR"></result> 
		<result property="activityType" column="ACTIVITY_TYPE"></result> 
		<result property="activityTypeDetails" column="ACTIVITY_TYPEDETAILS"></result> 
		<result property="activityInfo" column="ACTIVITY_INFO"></result> 
		<result property="activityPrice" column="ACTIVITY_PRICE"></result>
		<result property="activityCapacity" column="ACTIVITY_CAPACITY"></result> 
		<result property="activityEnrolldate" column="ACTIVITY_ENROLL_DATE"></result> 
		<result property="activityStartdate" column="ACTIVITY_START_DATE"></result> 
		<result property="activityEnddate" column="ACTIVITY_END_DATE"></result> 
		<result property="activityStatus" column="ACTIVITY_STATUS"></result> 
		<result property="aOriginalFilename" column="A_ORIGINAL_FILENAME"></result> 
		<result property="aRenameFilename" column="A_RENAME_FILENAME"></result> 
	</resultMap>
	
	<!-- 액티비티 전체 수 -->
	 <select id="selectListActivityCount" resultType="_int">
		SELECT COUNT (*) FROM ACTIVITY WHERE ACTIVITY_STATUS = 'Y'
	</select>

	<!-- 액티비티 총 목록 -->
	<select id="selectAllActivityList" resultMap="ActivityResultMap">
		SELECT * FROM ACTIVITY WHERE ACTIVITY_STATUS = 'Y' ORDER BY ACTIVITY_NO DESC
	</select>
	
	<!-- 액티비티 검색 -->
	<select id="selectSearchActivity" resultMap="ActivityResultMap">
		SELECT * FROM ACTIVITY WHERE 
		SHOP_ID LIKE '%' || #{activityKeyword} ||'%' AND
		ACTIVITY_NAME LIKE '%' || #{activityKeyword} ||'%' AND 
		ACTIVITY_TYPE LIKE '%' || #{activityKeyword} ||'%' AND 
		ACTIVITY_TYPEDETAILS LIKE '%' || #{activityKeyword} ||'%' AND
		ACTIVITY_INFO LIKE '%' || #{activityKeyword} ||'%'
		ORDER BY ACTIVITY_ENROLL_DATE DESC
	</select>

	<!-- 액티비티 상세조회 -->
	<select id="selectActivityOne" resultMap="ActivityResultMap">
		SELECT * FROM ACTIVITY WHERE ACTIVITY_NO = #{activityNo} AND ACTIVITY_STATUS = 'Y'
	</select>
	
	<!-- 액티비티 등록 -->
	<insert id="insertActivity">
		INSERT INTO ACTIVITY VALUES(SEQ_ACTIVITY_NO.NEXTVAL, 'shoptest',
		#{activityName},#{activityAddr}, #{activityType},NULL, #{activityInfo}, #{activityPrice}, #{activityCapacity},
		 SYSDATE, #{activityStartdate}, #{activityEnddate},DEFAULT,#{aOriginalFilename}, #{aRenameFilename})
	</insert>

	<!-- 액티비티 수정 -->
	<update id="updateActivity">
   		UPDATE ACTIVITY SET ACTIVITY_NAME = #{activityName }, ACTIVITY_ADDR = #{activityAddr }, 
   		ACTIVITY_TYPE = #{activityType }, ACTIVITY_TYPEDETAILS = NULL, ACTIVITY_INFO = #{activityInfo }, 
   		ACTIVITY_PRICE = #{activityPrice }, ACTIVITY_ENROLL_DATE = SYSDATE, 
   		ACTIVITY_START_DATE = #{activityStartdate }, ACTIVITY_END_DATE = #{activityEnddate }, 
   		A_ORIGINAL_FILENAME = #{aOriginalFilename }, A_RENAME_FILENAME = #{aRenameFilename }
   		WHERE ACTIVITY_NO = #{activityNo } AND ACTIVITY_STATUS = 'Y'
   </update>
	
	<!-- 액티비티 삭제(인 것 처럼 보여지는 것) -->
	<update id="deleteActivity" parameterType="_int">
		UPDATE ACTIVITY SET ACTIVITY_STATUS = 'N' WHERE ACTIVITY_NO = #{activityNo}
	</update>
	
	<!-- 조회 수
	<update id="updateActivityCount">
		UPDATE ACTIVITY SET ACTIVITY_COUNT = ACTIVITY_COUNT + 1 WHERE ACTIVITY_NO = #{activityNo }
	</update> -->
	
</mapper>